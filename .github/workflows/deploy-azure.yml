# name: Deploy Full Stack to Azure

# on:
#   push:
#     branches: [ main ]
#   workflow_dispatch:

# jobs:
#   build-backend:
#     runs-on: ubuntu-latest
#     steps:
#     - uses: actions/checkout@v4
    
#     - name: Set up Docker Buildx
#       uses: docker/setup-buildx-action@v3

#     - name: Login to Docker Hub
#       uses: docker/login-action@v3
#       with:
#         username: ${{ secrets.DOCKER_USERNAME }}
#         password: ${{ secrets.DOCKER_PASSWORD }}

#     - name: Build and push Backend
#       uses: docker/build-push-action@v5
#       with:
#         context: ./athletics_fastapi
#         push: true
#         tags: |
#           estebanlaguilar/athletics-fastapi:latest
#           estebanlaguilar/athletics-fastapi:${{ github.sha }}

#   build-frontend:
#     runs-on: ubuntu-latest
#     steps:
#     - uses: actions/checkout@v4
    
#     - name: Set up Docker Buildx
#       uses: docker/setup-buildx-action@v3

#     - name: Login to Docker Hub
#       uses: docker/login-action@v3
#       with:
#         username: ${{ secrets.DOCKER_USERNAME }}
#         password: ${{ secrets.DOCKER_PASSWORD }}

#     - name: Build and push Frontend
#       uses: docker/build-push-action@v5
#       with:
#         context: ./athletics_vite_ui
#         push: true
#         tags: |
#           estebanlaguilar/athletics-vite-ui:latest
#           estebanlaguilar/athletics-vite-ui:${{ github.sha }}
#         build-args: |
#           VITE_API_URL=https://atletismo-backend-bmfmgqh2fxbwekd5.westus3-01.azurewebsites.net

#   deploy-to-azure:
#     needs: [build-backend, build-frontend]
#     runs-on: ubuntu-latest
#     steps:
#     - name: Azure Login
#       uses: azure/login@v1
#       with:
#         creds: ${{ secrets.AZURE_CREDENTIALS }}

#     - name: Deploy Backend
#       uses: azure/webapps-deploy@v2
#       with:
#         app-name: atletismo-backend
#         images: estebanlaguilar/athletics-fastapi:latest

#     - name: Deploy Frontend
#       uses: azure/webapps-deploy@v2
#       with:
#         app-name: frontend-ui
#         images: estebanlaguilar/athletics-vite-ui:latest